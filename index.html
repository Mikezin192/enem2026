<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>ENEM 2026 ‚Äì CC</title>
<style>

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#09090b;--bg2:#111116;--bg3:#18181f;--bg4:#1f1f2a;--ac:#7c5cfc;--ac2:#a78bfa;--g:#22c55e;--r:#ef4444;--y:#eab308;--o:#f97316;--cy:#06b6d4;--pk:#ec4899;--t:#f0f0f5;--t2:#a0a0b8;--t3:#5a5a72;--bd:#2a2a3a}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--t);min-height:100vh;-webkit-tap-highlight-color:transparent}
.sr-only{position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0)}
.app{max-width:900px;margin:0 auto;padding:12px 12px 100px}

/* --- HEADER --- */
header{text-align:center;padding:24px 8px 16px}
.badge{display:inline-block;padding:3px 10px;background:rgba(124,92,252,.1);border:1px solid rgba(124,92,252,.2);border-radius:50px;font-size:.6rem;font-weight:700;color:var(--ac2);letter-spacing:.5px;text-transform:uppercase;margin-bottom:8px}
header h1{font-size:clamp(1.5rem,6vw,2.5rem);font-weight:900;letter-spacing:-2px;background:linear-gradient(135deg,#fff,var(--ac2),var(--cy));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
header p{color:var(--t3);font-size:.72rem;margin-top:4px}
.goals{display:flex;gap:5px;justify-content:center;flex-wrap:wrap;margin-top:6px}
.gl{padding:2px 8px;border-radius:4px;font-size:.54rem;font-weight:700}
.gl:nth-child(1){background:rgba(124,92,252,.12);color:var(--ac2)}
.gl:nth-child(2){background:rgba(239,68,68,.12);color:var(--r)}
.gl:nth-child(3){background:rgba(34,197,94,.12);color:var(--g)}

/* --- TIMER --- */
section.timer{background:var(--bg2);border:1px solid var(--bd);border-radius:14px;padding:16px;margin-bottom:10px;text-align:center}
.t-lbl{font-size:.62rem;color:var(--t3);font-weight:600;text-transform:uppercase;letter-spacing:1px}
.t-dots{display:flex;justify-content:center;gap:5px;margin:5px 0}
.t-dot{width:7px;height:7px;border-radius:50%;background:var(--bg4);transition:.3s}
.t-dot.at{background:var(--ac);box-shadow:0 0 6px var(--ac)}
.t-dot.ap{background:var(--g);box-shadow:0 0 6px var(--g)}
.t-dot.dn{background:var(--g)}
.t-disp{font-size:clamp(2.2rem,10vw,3.8rem);font-weight:900;font-variant-numeric:tabular-nums;letter-spacing:-2px;cursor:pointer;border-radius:10px;padding:2px 10px;display:inline-block;transition:.2s;user-select:none}
.t-disp:hover{background:var(--bg4)}
.t-disp.theory{color:var(--ac2)}.t-disp.practice{color:var(--g)}
.t-disp.overtime{color:var(--r);animation:blk 1s infinite}
.t-disp.editing{background:var(--bg4);outline:2px solid var(--ac)}
@keyframes blk{50%{opacity:.4}}
.t-edit{display:none;align-items:center;justify-content:center;gap:6px;margin:6px 0}
.t-edit.show{display:flex}
.t-edit input{width:50px;padding:6px;background:var(--bg);border:1px solid var(--bd);border-radius:6px;color:var(--t);font-family:inherit;font-size:.95rem;text-align:center;font-weight:700;outline:none}
.t-edit input:focus{border-color:var(--ac)}
.t-presets{display:flex;gap:3px;justify-content:center;margin:5px 0;flex-wrap:wrap}
.pre{padding:2px 7px;border:1px solid var(--bd);border-radius:4px;background:var(--bg);color:var(--t3);font-size:.5rem;font-weight:600;cursor:pointer;font-family:inherit}
.pre:hover{border-color:var(--ac);color:var(--ac2)}
.t-btns{display:flex;gap:6px;justify-content:center;margin-top:6px}
.tb{padding:8px 14px;border:none;border-radius:8px;font-family:inherit;font-size:.72rem;font-weight:700;cursor:pointer;touch-action:manipulation}
.tb:active{transform:scale(.95)}
.tb-go{background:var(--g);color:#fff}.tb-go.run{background:var(--y);color:#000}
.tb-sk{background:var(--ac);color:#fff}.tb-rs{background:var(--bg4);color:var(--t2);border:1px solid var(--bd)}
.t-bar{width:100%;height:4px;background:var(--bg);border-radius:4px;margin-top:8px;overflow:hidden}
.t-bf{height:100%;border-radius:4px;transition:width .5s}
.t-bf.theory{background:linear-gradient(90deg,var(--ac),var(--ac2))}
.t-bf.practice{background:linear-gradient(90deg,var(--g),var(--cy))}
.t-td{margin-top:6px;font-size:.58rem;color:var(--t3)}.t-td b{color:var(--g)}

/* --- STREAK --- */
aside.streak{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:10px 12px;margin-bottom:10px;display:flex;align-items:center;gap:10px}
.s-i{font-size:1.3rem;animation:flm 1s ease-in-out infinite alternate}
@keyframes flm{to{transform:scale(1.1) rotate(3deg)}}
.s-n{font-size:1.2rem;font-weight:900;color:var(--o)}.s-l{font-size:.5rem;color:var(--t3)}
.s-g{display:flex;gap:2px;margin-left:auto}.s-c{width:10px;height:10px;border-radius:2px;background:var(--bg)}
.s-c.on{background:var(--g)}.s-c.now{outline:2px solid var(--ac);outline-offset:1px}

/* --- STATS --- */
section.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;margin-bottom:10px}
.st{background:var(--bg2);border:1px solid var(--bd);border-radius:8px;padding:8px 4px;text-align:center;position:relative;overflow:hidden}
.st::after{content:'';position:absolute;top:0;left:0;right:0;height:2px}
.st:nth-child(1)::after{background:var(--ac)}.st:nth-child(2)::after{background:var(--g)}.st:nth-child(3)::after{background:var(--y)}
.st:nth-child(4)::after{background:var(--o)}.st:nth-child(5)::after{background:var(--cy)}.st:nth-child(6)::after{background:var(--pk)}
.sv{font-size:1.1rem;font-weight:800}
.st:nth-child(1) .sv{color:var(--ac2)}.st:nth-child(2) .sv{color:var(--g)}.st:nth-child(3) .sv{color:var(--y)}
.st:nth-child(4) .sv{color:var(--o)}.st:nth-child(5) .sv{color:var(--cy)}.st:nth-child(6) .sv{color:var(--pk)}
.sl{font-size:.44rem;color:var(--t3);text-transform:uppercase;letter-spacing:.7px;font-weight:700;margin-top:2px}

/* --- PROGRESS --- */
section.prog{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:12px;margin-bottom:10px}
.prog-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.prog-top h2{font-size:.75rem;font-weight:700}.prog-pct{font-size:.95rem;font-weight:800;color:var(--g)}
.pbar{height:6px;background:var(--bg);border-radius:6px;overflow:hidden}
.pbf{height:100%;background:linear-gradient(90deg,var(--ac),var(--g));border-radius:6px;transition:width .6s;position:relative}
.pbf::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.12),transparent);animation:shm 2.5s infinite}
@keyframes shm{0%{transform:translateX(-100%)}100%{transform:translateX(200%)}}
.pbars{display:grid;grid-template-columns:repeat(4,1fr);gap:4px;margin-top:8px}
.pm{text-align:center}.pm-l{font-size:.46rem;color:var(--t3);font-weight:600;margin-bottom:2px}
.pm-b{height:3px;background:var(--bg);border-radius:3px;overflow:hidden}
.pm-f{height:100%;border-radius:3px;transition:width .5s}
.pm:nth-child(1) .pm-f{background:var(--g)}.pm:nth-child(2) .pm-f{background:var(--y)}
.pm:nth-child(3) .pm-f{background:var(--ac)}.pm:nth-child(4) .pm-f{background:var(--r)}
.pm-p{font-size:.42rem;color:var(--t3);font-weight:700;margin-top:1px}

/* --- SYNC --- */
section.sync{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:10px;margin-bottom:10px}
.sync h3{font-size:.68rem;font-weight:700;margin-bottom:6px}
.sync-row{display:flex;gap:4px;flex-wrap:wrap}
.sb{padding:5px 9px;border:1px solid var(--bd);border-radius:6px;background:var(--bg3);color:var(--t2);font-family:inherit;font-size:.58rem;font-weight:600;cursor:pointer;touch-action:manipulation}
.sb:hover{border-color:var(--ac);color:var(--ac2)}.sb:active{transform:scale(.95)}
.sc{width:100%;margin-top:6px;padding:6px;background:var(--bg);border:1px solid var(--bd);border-radius:6px;color:var(--t);font-family:monospace;font-size:.5rem;resize:vertical;min-height:40px;display:none;outline:none}
.sc.show{display:block}.sc:focus{border-color:var(--ac)}
.imp{display:none;margin-top:4px;gap:4px}.imp.show{display:flex}

/* --- NAV --- */
nav.bar{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:12px}
.search{flex:1;min-width:100px;padding:6px 8px;background:var(--bg2);border:1px solid var(--bd);border-radius:6px;color:var(--t);font-family:inherit;font-size:.68rem;outline:none}
.search:focus{border-color:var(--ac)}.search::placeholder{color:var(--t3)}
.sel{padding:6px 4px;background:var(--bg2);border:1px solid var(--bd);border-radius:6px;color:var(--t);font-family:inherit;font-size:.62rem;outline:none}
.nb{padding:5px 8px;background:var(--bg3);border:1px solid var(--bd);border-radius:6px;color:var(--t2);font-family:inherit;font-size:.58rem;font-weight:600;cursor:pointer;touch-action:manipulation;white-space:nowrap}
.nb:hover{border-color:var(--ac);color:var(--ac2)}.nb:active{transform:scale(.95)}

/* --- PHASE --- */
section.ph{margin-bottom:14px}
.ph-h{display:flex;align-items:center;gap:8px;padding:10px 11px;background:var(--bg2);border:1px solid var(--bd);border-radius:10px;cursor:pointer;user-select:none;position:relative;overflow:hidden}
.ph-h:active{background:var(--bg3)}
.ph-h::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px}
.ph[data-p="1"] .ph-h::before{background:var(--g)}.ph[data-p="2"] .ph-h::before{background:var(--y)}
.ph[data-p="3"] .ph-h::before{background:var(--ac)}.ph[data-p="4"] .ph-h::before{background:var(--r)}
.ph-e{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.9rem;flex-shrink:0}
.ph[data-p="1"] .ph-e{background:rgba(34,197,94,.12)}.ph[data-p="2"] .ph-e{background:rgba(234,179,8,.12)}
.ph[data-p="3"] .ph-e{background:rgba(124,92,252,.12)}.ph[data-p="4"] .ph-e{background:rgba(239,68,68,.12)}
.ph-i{flex:1;min-width:0}.ph-t{font-weight:700;font-size:.72rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ph-s{font-size:.5rem;color:var(--t3)}
.ph-c{padding:2px 6px;border-radius:4px;font-size:.52rem;font-weight:700;background:var(--bg);white-space:nowrap}
.ph-a{font-size:.65rem;color:var(--t3);transition:transform .3s;margin-left:2px}
.ph.cl .ph-a{transform:rotate(-90deg)}
.ph-b{padding-left:2px;overflow:hidden;transition:max-height .4s,opacity .3s}
.ph.cl .ph-b{max-height:0!important;opacity:0}

/* --- WEEK --- */
article.wk{margin:7px 0 0 4px;border-left:2px solid var(--bd);padding-left:8px}
.wk-h{display:flex;align-items:center;gap:5px;padding:5px 7px;cursor:pointer;border-radius:6px;user-select:none}
.wk-h:active{background:var(--bg3)}
.wk-d{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.wk-d.cpl{background:var(--g)!important;box-shadow:0 0 4px rgba(34,197,94,.3)}
.wk-t{font-weight:600;font-size:.68rem;flex:1}
.wk-bg{font-size:.48rem;padding:1px 4px;border-radius:3px;font-weight:700;background:var(--bg);color:var(--t3);white-space:nowrap}
.wk-bg.wd{background:rgba(34,197,94,.1);color:var(--g)}
.wk-ar{font-size:.55rem;color:var(--t3);transition:transform .3s}
.wk.cl .wk-ar{transform:rotate(-90deg)}
.wk-b{padding:2px 0 2px 2px;display:grid;gap:3px;overflow:hidden;transition:max-height .3s,opacity .2s}
.wk.cl .wk-b{max-height:0!important;opacity:0;padding:0}

/* --- TASK --- */
article.tk{display:grid;grid-template-columns:auto 1fr auto;gap:8px;align-items:center;padding:8px 10px;background:var(--bg2);border:1px solid var(--bd);border-radius:8px;position:relative}
article.tk::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;border-radius:3px 0 0 3px}
.tk.p-alta::before{background:var(--r)}.tk.p-media::before{background:var(--y)}.tk.p-baixa::before{background:var(--g)}
.tk:active{background:var(--bg3)}.tk.done{opacity:.4}.tk.done h4{text-decoration:line-through;color:var(--t3)}
.tk.multi{border-left:3px solid var(--o)}.tk.multi::before{display:none}
.tk.sim{border-left:3px solid var(--r)}.tk.sim::before{display:none}
.tk.rest{border-left:3px solid var(--g);opacity:.7}.tk.rest::before{display:none}

.ck{width:28px;height:28px;border-radius:6px;border:2px solid var(--bd);background:transparent;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s cubic-bezier(.175,.885,.32,1.275);flex-shrink:0;touch-action:manipulation;position:relative;font-size:0}
.ck:active{transform:scale(.85)}.ck.on{background:var(--g);border-color:var(--g);animation:pop .4s}
.ck.on::after{content:'‚úì';font-size:13px;color:#fff;font-weight:800}
@keyframes pop{30%{transform:scale(1.3)}60%{transform:scale(.9)}}

.tk-c{min-width:0}
.tk-c h4{font-weight:600;font-size:.7rem;line-height:1.3}
.tk-c p{font-size:.6rem;color:var(--t2);line-height:1.4;margin-top:1px;display:none}
.tk.exp .tk-c p{display:block}
.tk-tags{display:flex;gap:2px;flex-wrap:wrap;margin-top:3px}
.tg{padding:0 4px;border-radius:2px;font-size:.42rem;font-weight:700;text-transform:uppercase}
.tg-Mat{background:rgba(124,92,252,.1);color:var(--ac2)}.tg-F√≠s{background:rgba(249,115,22,.1);color:var(--o)}
.tg-Qu√≠{background:rgba(34,197,94,.1);color:var(--g)}.tg-Bio{background:rgba(6,182,212,.1);color:var(--cy)}
.tg-Hum{background:rgba(234,179,8,.1);color:var(--y)}.tg-Ling{background:rgba(236,72,153,.1);color:var(--pk)}
.tg-Red{background:rgba(168,85,247,.1);color:#a78bfa}.tg-Rev{background:rgba(100,100,130,.1);color:var(--t2)}
.tg-Sim{background:rgba(239,68,68,.1);color:var(--r)}.tg-OFF{background:rgba(34,197,94,.06);color:var(--g)}

.tk-m{display:flex;flex-direction:column;align-items:flex-end;gap:1px;min-width:40px}
.tk-m .dy{font-size:.48rem;color:var(--t3);font-weight:600}
.tk-m time{font-size:.54rem;color:var(--t2);font-weight:700}
.nbtn{padding:1px 4px;background:var(--bg);border:1px solid var(--bd);border-radius:3px;color:var(--t3);font-size:.46rem;cursor:pointer;font-family:inherit}
.nbtn.has{color:var(--y);border-color:rgba(234,179,8,.3)}

dialog{background:var(--bg2);border:1px solid var(--bd);border-radius:12px;padding:20px;width:90%;max-width:400px;color:var(--t)}
dialog::backdrop{background:rgba(0,0,0,.8);backdrop-filter:blur(6px)}
dialog h3{font-size:.8rem;margin-bottom:2px}
dialog .msub{font-size:.62rem;color:var(--t3);margin-bottom:8px}
dialog textarea{width:100%;height:80px;background:var(--bg);border:1px solid var(--bd);border-radius:6px;padding:8px;color:var(--t);font-family:inherit;font-size:.68rem;resize:vertical;outline:none}
dialog textarea:focus{border-color:var(--ac)}
.mbtn{display:flex;gap:6px;margin-top:8px;justify-content:flex-end}
.bt{padding:6px 12px;border:none;border-radius:6px;font-family:inherit;font-size:.68rem;font-weight:600;cursor:pointer}
.bt:active{transform:scale(.95)}.bt-p{background:var(--ac);color:#fff}.bt-g{background:var(--bg);color:var(--t2);border:1px solid var(--bd)}

.toasts{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);z-index:9999;display:flex;flex-direction:column;gap:4px;align-items:center;width:85%;max-width:300px}
.toast{padding:8px 12px;background:var(--bg3);border:1px solid var(--bd);border-radius:8px;font-size:.68rem;box-shadow:0 8px 20px rgba(0,0,0,.4);animation:ti .3s,to .3s 2.5s forwards;text-align:center;width:100%}
@keyframes ti{from{transform:translateY(20px);opacity:0}}
@keyframes to{to{opacity:0;transform:translateY(10px)}}
#confetti{position:fixed;inset:0;pointer-events:none;z-index:99999}
.empty{text-align:center;padding:30px;color:var(--t3);font-size:.75rem}

@media(max-width:480px){
.stats{gap:3px}.sv{font-size:.95rem}.pbars{grid-template-columns:repeat(2,1fr)}
article.tk{grid-template-columns:auto 1fr}.tk-m{grid-column:1/-1;flex-direction:row;flex-wrap:wrap;gap:4px}
.s-g{display:none}nav.bar{flex-direction:column}.search{min-width:100%}
article.wk{margin-left:1px;padding-left:6px}.sync-row{flex-direction:column}.sb{width:100%}
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
<canvas id="confetti" aria-hidden="true"></canvas>
<div class="app">

<!-- ===== HEADER ===== -->
<header>
<div class="badge">üñ•Ô∏è Ci√™ncia da Computa√ß√£o ‚Ä¢ Federal 2026</div>
<h1>ENEM 2026</h1>
<p>2h/dia ‚Äî 35min Teoria + 85min Quest√µes</p>
<div class="goals"><span class="gl">üéØ 800+ Mat</span><span class="gl">üìù 900+ Red</span><span class="gl">üß™ 700+ Nat</span></div>
<div id="hojeDestaque" style="background:var(--bg2); border:2px solid var(--ac); border-radius:12px; padding:12px; margin:12px 0; text-align:center; font-weight:700;">
    <span style="font-size:1.1rem;" id="dataHojeTexto">Carregando data...</span><br>
    <span id="tarefaHoje" style="color:var(--ac2); font-size:1rem;"></span>
</div>
</header>

<!-- ===== TIMER ===== -->
<section class="timer" aria-label="Temporizador">
<div class="t-lbl" data-t="lbl">üìñ TEORIA</div>
<div class="t-dots"><div class="t-dot" data-t="d1"></div><div class="t-dot" data-t="d2"></div></div>
<div class="t-disp theory" data-t="disp" role="button" tabindex="0" aria-label="Editar tempo" onclick="openEd()">35:00</div>
<div class="t-edit" data-t="edit">
<label for="em" class="sr-only">Min</label><input type="number" id="em" min="0" max="999" value="35">
<span style="color:var(--t3);font-weight:700">:</span>
<label for="es" class="sr-only">Seg</label><input type="number" id="es" min="0" max="59" value="0">
<button type="button" class="bt bt-p" onclick="applyEd()">‚úì</button>
<button type="button" class="bt bt-g" onclick="cancelEd()">‚úï</button>
</div>
<div class="t-presets">
<button type="button" class="pre" onclick="pre(25)">25</button>
<button type="button" class="pre" onclick="pre(35)">35</button>
<button type="button" class="pre" onclick="pre(45)">45</button>
<button type="button" class="pre" onclick="pre(60)">60</button>
<button type="button" class="pre" onclick="pre(90)">90</button>
</div>
<div class="t-btns">
<button type="button" class="tb tb-go" data-t="go" onclick="tTog()" aria-label="Iniciar/pausar">‚ñ∂ Iniciar</button>
<button type="button" class="tb tb-sk" onclick="tSkip()" aria-label="Pular">‚è≠</button>
<button type="button" class="tb tb-rs" onclick="tRst()" aria-label="Reset">‚Ü∫</button>
</div>
<div class="t-bar"><div class="t-bf theory" data-t="bar" style="width:100%"></div></div>
<div class="t-td">Hoje: <b data-t="tot">0 min</b></div>
</section>
<section style="margin:20px 0; border:1px solid var(--bd); border-radius:12px; overflow:hidden;">
    <h3 style="padding:12px; background:var(--bg2); margin:0; text-align:center;">Simulad√£o Oficial MEC Enem</h3>
    <iframe src="https://app.mecenem.mec.gov.br" width="100%" height="600px" frameborder="0" allowfullscreen></iframe>
    <p style="text-align:center; font-size:0.8rem; color:var(--t3); padding:8px;">Acesse simulados, corre√ß√£o de reda√ß√£o autom√°tica e trilhas de estudo gr√°tis. Login Gov.br necess√°rio para algumas fun√ß√µes.</p>
</section>

<!-- ===== STREAK ===== -->
<aside class="streak" aria-label="Streak"><span class="s-i" aria-hidden="true">üî•</span><div><div class="s-n" data-s="n">0</div><div class="s-l">DIAS SEGUIDOS</div></div><div class="s-g" data-s="g"></div></aside>

<!-- ===== STATS ===== -->
<section class="stats" aria-label="Estat√≠sticas">
<div class="st"><div class="sv" data-st="total">0</div><div class="sl">Total</div></div>
<div class="st"><div class="sv" data-st="done">0</div><div class="sl">Feitas</div></div>
<div class="st"><div class="sv" data-st="pend">0</div><div class="sl">Pendentes</div></div>
<div class="st"><div class="sv" data-st="today">0</div><div class="sl">Hoje</div></div>
<div class="st"><div class="sv" data-st="red">0</div><div class="sl">Reda√ß√µes</div></div>
<div class="st"><div class="sv" data-st="sim">0</div><div class="sl">Simulados</div></div>
</section>

<!-- ===== PROGRESS ===== -->
<section class="prog" aria-label="Progresso">
<div class="prog-top"><h2>üìä Progresso</h2><span class="prog-pct" data-pr="pct">0%</span></div>
<div class="pbar"><div class="pbf" data-pr="bar"></div></div>
<div class="pbars">
<div class="pm"><div class="pm-l">üü¢F1</div><div class="pm-b"><div class="pm-f" data-pr="f1"></div></div><div class="pm-p" data-pr="p1">0%</div></div>
<div class="pm"><div class="pm-l">üü°F2</div><div class="pm-b"><div class="pm-f" data-pr="f2"></div></div><div class="pm-p" data-pr="p2">0%</div></div>
<div class="pm"><div class="pm-l">üîµF3</div><div class="pm-b"><div class="pm-f" data-pr="f3"></div></div><div class="pm-p" data-pr="p3">0%</div></div>
<div class="pm"><div class="pm-l">üî¥F4</div><div class="pm-b"><div class="pm-f" data-pr="f4"></div></div><div class="pm-p" data-pr="p4">0%</div></div>
</div>
</section>

<!-- ===== SYNC ===== -->
<section class="sync" aria-label="Sincronizar">
<h3>üîÑ Sincronizar</h3>
<div class="sync-row">
<button type="button" class="sb" onclick="expP()">üì§ Exportar</button>
<button type="button" class="sb" onclick="showI()">üì• Importar</button>
<button type="button" class="sb" onclick="cpC()">üìã Copiar</button>
<button type="button" class="sb" onclick="shP()">üì± Share</button>
</div>
<textarea class="sc" id="sc" placeholder="Cole o c√≥digo..."></textarea>
<div class="imp" data-sy="ib">
<button type="button" class="sb" onclick="impP()" style="background:var(--g);color:#fff;border-color:var(--g)">‚úÖ OK</button>
<button type="button" class="sb" onclick="hideI()">‚úñ</button>
</div>
</section>


<!-- ===== NAV ===== -->
<nav class="bar" aria-label="Filtros">
<label for="si" class="sr-only">Buscar</label>
<input class="search" id="si" placeholder="üîç Buscar..." oninput="draw()">
<select class="sel" id="ff" onchange="draw()" aria-label="Fase"><option value="">Fases</option><option value="1">üü¢F1</option><option value="2">üü°F2</option><option value="3">üîµF3</option><option value="4">üî¥F4</option></select>
<select class="sel" id="fm" onchange="draw()" aria-label="Mat√©ria"><option value="">Mat.</option><option value="Mat">Mat</option><option value="F√≠s">F√≠s</option><option value="Qu√≠">Qu√≠</option><option value="Bio">Bio</option><option value="Hum">Hum</option><option value="Ling">Ling</option><option value="Red">Red</option></select>
<select class="sel" id="fs" onchange="draw()" aria-label="Status"><option value="">Status</option><option value="p">Pendentes</option><option value="d">Feitas</option></select>
<button type="button" class="nb" onclick="eAll()">üìÇ</button>
<button type="button" class="nb" onclick="cAll()">üìÅ</button>
<button type="button" class="nb" onclick="eCSV()">CSV</button>
<button type="button" class="nb" onclick="toggleMusic()">üéß Lo-fi</button>
<button type="button" class="nb" onclick="exportAsImage()">üñºÔ∏è Export Img</button>
<button type="button" class="nb" onclick="showNotesList()">üìã Notas</button>
<button type="button" class="nb" onclick="requestNotificationPermission()">üîî Ativar Notifs</button>
<button type="button" class="nb" onclick="showSpacedReview()">üîÑ Revis√£o Espa√ßada</button>
<button type="button" class="nb" onclick="showRedGallery()">üñºÔ∏è Reda√ß√µes</button>
<button type="button" class="nb" onclick="copyDiaInteiro()">üìã Copiar Dia</button>
<button type="button" class="nb" onclick="rAll()">üîÑ</button>
</nav>

<!-- ===== MAIN ===== -->
<main id="ct" aria-label="Cronograma"></main>
</div>

<!-- ===== DIALOG ===== -->
<dialog id="dlg">
    <h3>üìù Anota√ß√µes</h3>
    <div class="msub" data-dl="t"></div>
    <textarea id="nt" placeholder="Erros, d√∫vidas..."></textarea>
    <div id="redExtra" style="display:none; margin-top:12px;">
        <label>Nota da reda√ß√£o (0-1000):</label>
        <input type="number" id="redNota" min="0" max="1000" style="width:80px;">
        <br><br>
        <label>Foto da reda√ß√£o:</label>
        <input type="file" id="redImg" accept="image/*">
        <div id="imgPreview" style="margin-top:8px;max-height:200px;overflow:hidden;"></div>
    </div>
    <div class="mbtn">
        <button type="button" class="bt bt-g" onclick="cDlg()">Cancelar</button>
        <button type="button" class="bt bt-p" onclick="sN()">üíæ Salvar</button>
    </div>
</dialog>
<div class="toasts" id="toasts" aria-live="polite"></div>

<div id="musicPlayer" style="display:none; position:fixed; bottom:80px; left:10px; right:10px; z-index:100; background:var(--bg2); padding:12px; border-radius:12px; border:1px solid var(--bd);">
    <h4 style="margin:0 0 8px; font-size:0.9rem; color:var(--t2);">Lo-fi / Playlist</h4>
    
    <!-- Campo para colar link ou ID -->
    <input type="text" id="playlistInput" placeholder="Cole link da playlist ou v√≠deo aqui..." 
           style="width:100%; padding:8px; margin-bottom:8px; background:var(--bg); border:1px solid var(--bd); border-radius:6px; color:var(--t); font-family:inherit;">
    
    <!-- Bot√£o para aplicar -->
    <button onclick="loadCustomMusic()" class="bt bt-p" style="width:100%; margin-bottom:8px;">Carregar üéµ</button>
    
    <!-- Iframe do player -->
    <iframe id="lofiFrame" width="100%" height="80" 
            src="https://www.youtube-nocookie.com/embed/cIZhlFIyJ_Y?autoplay=0&controls=1&mute=0" 
            frameborder="0" allow="autoplay; encrypted-media" allowfullscreen 
            referrerpolicy="strict-origin-when-cross-origin">
    </iframe>
    
    <!-- Bot√£o fechar -->
    <button onclick="toggleMusic()" style="position:absolute;top:8px;right:10px;background:transparent;border:none;color:var(--t);font-size:1.2rem;">‚úñ</button>
</div>

<script>
// ===== DADOS =====
// [id, semana, fase, dia, data, [mat], titulo, detalhes, tipo, pri, multi?, rest?]
// rest = S√°b/Dom de descanso agrupado
const D=[
// FASE 1
["1.1a",1,1,"Seg","2026-02-09",["Mat","F√≠s"],"Opera√ß√µes B√°sicas + Nota√ß√£o Cient√≠fica","(Mat) V√≠rgula e Fra√ß√£o. (F√≠s) Nota√ß√£o Cient√≠fica, Convers√£o.","Teoria","alta"],
["1.1b",1,1,"Ter","2026-02-10",["Mat","Qu√≠"],"Regra de Tr√™s + Estados F√≠sicos","(Mat) Simples/Composta. (Qu√≠) Mudan√ßas de Fase.","Teoria","alta"],
["1.1c",1,1,"Qua","2026-02-11",["Mat","Bio"],"Porcentagem + √Ågua/Sais","(Mat) Aumentos/Descontos. (Bio) √Ågua e Sais Minerais.","Teoria","alta"],
["1.1d",1,1,"Qui","2026-02-12",["Hum","Ling"],"Fato x Opini√£o + Interpreta√ß√£o","(Hum) Fato x Opini√£o. (Ling) Interpreta√ß√£o B√°sica.","Teoria","media"],
["1.1e",1,1,"Sex","2026-02-13",["Red","Mat"],"Estrutura Dissertativa + 20Q","(Red) Estrutura Dissertativa. (Mat) 20 Quest√µes.","Red+Q","alta"],
["1.1r",1,1,"S√°b/Dom","2026-02-14",["OFF"],"Descanso ou mat√©ria atrasada","Descanso ou colocar mat√©ria atrasada em dia.","Livre","baixa",false,true],

["1.2a",2,1,"Seg","2026-02-16",["Mat","F√≠s"],"Raz√£o/Propor√ß√£o + Vetores","(Mat) Escala/Densidade. (F√≠s) Soma e Decomposi√ß√£o.","Teoria","alta"],
["1.2b",2,1,"Ter","2026-02-17",["Mat","Qu√≠"],"Potencia√ß√£o + Separa√ß√£o Misturas","(Mat) Potencia√ß√£o/Radicia√ß√£o. (Qu√≠) Separa√ß√£o.","Teoria","media"],
["1.2c",2,1,"Qua","2026-02-18",["Mat","Bio"],"Equa√ß√£o 1¬∫Grau + Cadeias","(Mat) Problemas. (Bio) Cadeias/Teias.","Teoria","alta"],
["1.2d",2,1,"Qui","2026-02-19",["Hum","Ling"],"√âtica/Moral + G√™neros","(Hum) √âtica/Moral. (Ling) Not√≠cia, Artigo.","Teoria","media"],
["1.2e",2,1,"Sex","2026-02-20",["Red","Mat"],"Projeto Texto + 20Q","(Red) Planejamento. (Mat) 20Q Raz√£o/Propor√ß√£o.","Red+Q","alta"],
["1.2r",2,1,"S√°b/Dom","2026-02-21",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["1.3a",3,1,"Seg","2026-02-23",["Mat","F√≠s"],"Fun√ß√£o 1¬∫Grau + Vel.M√©dia","(Mat) Gr√°ficos. (F√≠s) v=Œîs/Œît.","Teoria","alta"],
["1.3b",3,1,"Ter","2026-02-24",["Mat","Qu√≠"],"Juros + Modelos At√¥micos","(Mat) Simples/Compostos. (Qu√≠) Bohr/Dalton.","Teoria","alta"],
["1.3c",3,1,"Qua","2026-02-25",["Mat","Bio"],"Inequa√ß√µes + Ciclos Bio","(Mat) Inequa√ß√µes. (Bio) √Ågua/Carbono.","Teoria","media"],
["1.3d",3,1,"Qui","2026-02-26",["Hum","Ling"],"Cidadania + Fun√ß√µes Ling.","(Hum) Democracia. (Ling) Jakobson.","Teoria","media"],
["1.3e",3,1,"Sex","2026-02-27",["Red","Mat"],"Intro/Tese + 20Q Afim","(Red) Introdu√ß√£o+Tese. (Mat) 20Q.","Red+Q","alta"],
["1.3r",3,1,"S√°b/Dom","2026-02-28",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["1.4a",4,1,"Seg","2026-03-02",["Mat","F√≠s"],"Fun√ß√£o 2¬∫Grau + MRUV","(Mat) V√©rtice/Ra√≠zes. (F√≠s) Acelera√ß√£o.","Teoria","alta"],
["1.4b",4,1,"Ter","2026-03-03",["Mat","Qu√≠"],"Gr√°ficos + Tab.Peri√≥dica","(Mat) Interpreta√ß√£o. (Qu√≠) Tabela.","Teoria","media"],
["1.4c",4,1,"Qua","2026-03-04",["Mat","Bio"],"Exponencial + Citologia","(Mat) Crescimento. (Bio) Membrana/Transporte.","Teoria","alta"],
["1.4d",4,1,"Qui","2026-03-05",["Hum","Ling"],"Cultura + Varia√ß√£o Ling.","(Hum) Patrim√¥nio. (Ling) Varia√ß√£o.","Teoria","media"],
["1.4e",4,1,"Sex","2026-03-06",["Red","Mat"],"Desenvolvimento + 20Q Quadr√°tica","(Red) Argumenta√ß√£o. (Mat) 20Q.","Red+Q","alta"],
["1.4r",4,1,"S√°b/Dom","2026-03-07",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["1.5a",5,1,"Seg","2026-03-09",["Mat","F√≠s"],"Logaritmos + Gr√°f.Cinem√°tica","(Mat) Defini√ß√£o/Propriedades. (F√≠s) S√ót, V√ót.","Teoria","alta"],
["1.5b",5,1,"Ter","2026-03-10",["Mat","Qu√≠"],"Fun√ß√£o Log + Liga√ß√µes","(Mat) Gr√°fico. (Qu√≠) I√¥nica/Covalente.","Teoria","media"],
["1.5c",5,1,"Qua","2026-03-11",["Mat","Bio"],"Estat√≠stica + Organelas","(Mat) M√©dia/Moda/Mediana. (Bio) Organelas.","Teoria","alta"],
["1.5d",5,1,"Qui","2026-03-12",["Hum","Ling"],"Estado/Poder + Escolas Lit.","(Hum) Sociologia. (Ling) Resum√£o Escolas.","Teoria","media"],
["1.5e",5,1,"Sex","2026-03-13",["Red","Mat"],"Conclus√£o + 20Q Estat.","(Red) Proposta Interven√ß√£o. (Mat) 20Q.","Red+Q","alta"],
["1.5r",5,1,"S√°b/Dom","2026-03-14",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["1.6a",6,1,"Seg","2026-03-16",["Mat","F√≠s"],"Tabelas + MCU","(Mat) Interpreta√ß√£o Tabelas. (F√≠s) MCU.","Teoria","alta"],
["1.6b",6,1,"Ter","2026-03-17",["Mat","Qu√≠"],"Desvio Padr√£o + Intermoleculares","(Mat) Conceito. (Qu√≠) Solubilidade.","Teoria","media"],
["1.6c",6,1,"Qua","2026-03-18",["Mat","Bio"],"Rev.Mat + S√≠nt.Proteica","(Mat) Revis√£o. (Bio) DNA‚ÜíRNA‚ÜíProte√≠na.","Revis√£o","media"],
["1.6d",6,1,"Qui","2026-03-19",["Hum","Ling"],"Trabalho + Fig.Linguagem","(Hum) Desigualdade. (Ling) Met√°fora/Ironia.","Teoria","media"],
["1.6e",6,1,"Sex","2026-03-20",["Red","Rev"],"Texto 1 + Erros Semana","(Red) Texto Completo 1. (Rev) Erros da semana.","Red+Rev","alta"],
["1.6r",6,1,"S√°b/Dom","2026-03-21",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["1.7a",7,1,"Seg","2026-03-23",["F√≠s","Mat"],"Newton 1¬™/2¬™ + Ex.Mistos","(F√≠s) F=ma. (Mat) Exerc√≠cios Mistos.","Teoria","alta"],
["1.7b",7,1,"Ter","2026-03-24",["F√≠s","Qu√≠"],"3¬™ Lei + √Åcidos/Bases","(F√≠s) A√ß√£o/Rea√ß√£o. (Qu√≠) pH.","Teoria","alta"],
["1.7c",7,1,"Qua","2026-03-25",["F√≠s","Bio"],"Atrito + 1¬™ Lei Mendel","(F√≠s) Est√°tico/Cin√©tico. (Bio) Gen√©tica.","Teoria","alta"],
["1.7d",7,1,"Qui","2026-03-26",["Hum","Ling"],"Globaliza√ß√£o + Poesia","(Hum) Geopol√≠tica. (Ling) Interpretar.","Teoria","media"],
["1.7e",7,1,"Sex","2026-03-27",["Red","Mat"],"Texto 2 + Rev.R√°pida","(Red) Texto 2. (Mat) Revis√£o.","Red+Rev","alta"],
["1.7f",7,1,"S√°b","2026-03-28",["Sim"],"üö® Simulado Diagn√≥stico (15+15Q)","15Q Mat + 15Q Natureza.","Simulado","alta"],
["1.7g",7,1,"Dom","2026-03-29",["Rev"],"üîç Corre√ß√£o e An√°lise","Classificar cada erro.","Revis√£o","alta"],

["1.8x",8,1,"Seg a Sex","2026-03-30",["Mat"],"üéØ SEMANA FOCO: ENEM 2021/2022","Resolver provas Mat ENEM 2021 e 2022. S√≥ assuntos vistos. Zero teoria.","Quest√µes","alta",true],
["1.8r",8,1,"S√°b/Dom","2026-04-04",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

// FASE 2
["2.9a",9,2,"Seg","2026-04-06",["Mat","F√≠s"],"√Çngulos/Tri√¢ngulos + Trabalho","(Mat) Tri√¢ngulos. (F√≠s) W=Fd.cosŒ∏.","Teoria","alta"],
["2.9b",9,2,"Ter","2026-04-07",["Mat","Qu√≠"],"Semelhan√ßa + Sais/√ìxidos","(Mat) Tales. (Qu√≠) Chuva √Åcida.","Teoria","media"],
["2.9c",9,2,"Qua","2026-04-08",["Mat","Bio"],"Pit√°goras + Doen√ßas","(Mat) Pit√°goras. (Bio) V√≠rus/Bact√©rias.","Teoria","alta"],
["2.9d",9,2,"Qui","2026-04-09",["Hum","Ling"],"Rev.Industriais + Modernismo 1¬™","(Hum) Impacto Social. (Ling) Oswald.","Teoria","media"],
["2.9e",9,2,"Sex","2026-04-10",["Red","Mat"],"Texto 3 + 20Q Geo Plana","(Red) Texto 3. (Mat) 20Q.","Red+Q","alta"],
["2.9r",9,2,"S√°b/Dom","2026-04-11",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.10a",10,2,"Seg","2026-04-13",["Mat","F√≠s"],"√Åreas + Energia","(Mat) Quadril√°teros. (F√≠s) Ec/Ep.","Teoria","alta"],
["2.10b",10,2,"Ter","2026-04-14",["Mat","Qu√≠"],"√Åreas Circ. + Balanceamento","(Mat) C√≠rculo/Setor. (Qu√≠) Equa√ß√µes.","Teoria","media"],
["2.10c",10,2,"Qua","2026-04-15",["Mat","Bio"],"Pol√≠gonos + Protozooses","(Mat) Regulares. (Bio) Saneamento.","Teoria","media"],
["2.10d",10,2,"Qui","2026-04-16",["Hum","Ling"],"Urbaniza√ß√£o + Modernismo 2¬™","(Hum) Segrega√ß√£o. (Ling) Drummond.","Teoria","media"],
["2.10e",10,2,"Sex","2026-04-17",["Red","Mat"],"Texto 4 + 20Q √Åreas","","Red+Q","alta"],
["2.10r",10,2,"S√°b/Dom","2026-04-18",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.11a",11,2,"Seg","2026-04-20",["Mat","F√≠s"],"Prismas + Conserv.Energia","(Mat) Volume. (F√≠s) Ec+Ep=cte.","Teoria","alta"],
["2.11b",11,2,"Ter","2026-04-21",["Mat","Qu√≠"],"Cilindros + Leis Ponderais","","Teoria","media"],
["2.11c",11,2,"Qua","2026-04-22",["Mat","Bio"],"Pir√¢mides/Cones + Digest√≥rio","","Teoria","media"],
["2.11d",11,2,"Qui","2026-04-23",["Hum","Ling"],"Agropecu√°ria + Arte Contemp.","","Teoria","media"],
["2.11e",11,2,"Sex","2026-04-24",["Red","Mat"],"Texto 5 + 20Q Prismas","","Red+Q","alta"],
["2.11r",11,2,"S√°b/Dom","2026-04-25",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.12a",12,2,"Seg","2026-04-27",["Mat","F√≠s"],"Esferas + Impulso","","Teoria","media"],
["2.12b",12,2,"Ter","2026-04-28",["Mat","Qu√≠"],"Proje√ß√£o Ortogonal + Esteq.","","Teoria","alta"],
["2.12c",12,2,"Qua","2026-04-29",["Mat","Bio"],"Troncos + Circulat√≥rio","","Teoria","media"],
["2.12d",12,2,"Qui","2026-04-30",["Hum","Ling"],"Migra√ß√µes + Argumenta√ß√£o","","Teoria","media"],
["2.12e",12,2,"Sex","2026-05-01",["Red","Mat"],"Texto 6 + 20Q Proje√ß√£o","","Red+Q","alta"],
["2.12r",12,2,"S√°b/Dom","2026-05-02",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.13a",13,2,"Seg","2026-05-04",["Mat","F√≠s"],"Trigono + Hidrost√°tica","(Mat) Sen/Cos/Tg. (F√≠s) Press√£o.","Teoria","alta"],
["2.13b",13,2,"Ter","2026-05-05",["Mat","Qu√≠"],"Senos/Cossenos + Esteq.II","","Teoria","media"],
["2.13c",13,2,"Qua","2026-05-06",["Mat","Bio"],"Ciclo Trigo + Respirat√≥rio","","Teoria","media"],
["2.13d",13,2,"Qui","2026-05-07",["Hum","Ling"],"Totalitarismo + Vanguardas","","Teoria","media"],
["2.13e",13,2,"Sex","2026-05-08",["Red","Mat"],"Texto 7 + 20Q Trigono","","Red+Q","alta"],
["2.13r",13,2,"S√°b/Dom","2026-05-09",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.14a",14,2,"Seg","2026-05-11",["Mat","F√≠s"],"Probabilidade + Empuxo","","Teoria","alta"],
["2.14b",14,2,"Ter","2026-05-12",["Mat","Qu√≠"],"Uni√£o/Intersec√ß√£o + Solu√ß√µes","","Teoria","alta"],
["2.14c",14,2,"Qua","2026-05-13",["Mat","Bio"],"Prob.Condicional + Imunologia","(Bio) Vacina x Soro!","Teoria","alta"],
["2.14d",14,2,"Qui","2026-05-14",["Hum","Ling"],"Brasil Col√¥nia + Rev Fun√ß√µes","","Teoria","media"],
["2.14e",14,2,"Sex","2026-05-15",["Red","Mat"],"Texto 8 + 20Q Prob.","","Red+Q","alta"],
["2.14r",14,2,"S√°b/Dom","2026-05-16",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.15a",15,2,"Seg","2026-05-18",["Mat","F√≠s"],"PFC + Dilata√ß√£o","","Teoria","alta"],
["2.15b",15,2,"Ter","2026-05-19",["Mat","Qu√≠"],"Permuta√ß√£o + Termoqu√≠mica","","Teoria","media"],
["2.15c",15,2,"Qua","2026-05-20",["Mat","Bio"],"Arranjo x Combina√ß√£o + Evolu√ß√£o","","Teoria","alta"],
["2.15d",15,2,"Qui","2026-05-21",["Hum","Ling"],"Escravid√£o + Coes√£o","","Teoria","media"],
["2.15e",15,2,"Sex","2026-05-22",["Red","Mat"],"Texto 9 + 20Q PFC","","Red+Q","alta"],
["2.15r",15,2,"S√°b/Dom","2026-05-23",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.16a",16,2,"Seg","2026-05-25",["Mat","F√≠s"],"Comb.Avan√ßada + Calorimetria","(F√≠s) Q=mcŒîT.","Teoria","alta"],
["2.16b",16,2,"Ter","2026-05-26",["Mat","Qu√≠"],"Rev Prob+Comb + Hess","","Revis√£o","media"],
["2.16c",16,2,"Qua","2026-05-27",["Mat","Bio"],"PA + Biotecnologia","","Teoria","alta"],
["2.16d",16,2,"Qui","2026-05-28",["Hum","Ling"],"Era Vargas + Publicidade","","Teoria","media"],
["2.16e",16,2,"Sex","2026-05-29",["Red","Rev"],"Texto 10 + Rev.Geral","","Red+Rev","alta"],
["2.16f",16,2,"S√°b","2026-05-30",["Sim"],"üö® Simulado Geo/Prob/Comb","","Simulado","alta"],
["2.16g",16,2,"Dom","2026-05-31",["Rev"],"üîç Corre√ß√£o Detalhada","","Revis√£o","alta"],

["2.17a",17,2,"Seg","2026-06-01",["Mat","F√≠s"],"PG + Termodin√¢mica","","Teoria","alta"],
["2.17b",17,2,"Ter","2026-06-02",["Mat","Qu√≠"],"Mat Financeira + Le Chatelier","","Teoria","alta"],
["2.17c",17,2,"Qua","2026-06-03",["Mat","Bio"],"Sist.Lineares + Meio Ambiente","","Teoria","alta"],
["2.17d",17,2,"Qui","2026-06-04",["Hum","Ling"],"Ditadura + Jornalismo","","Teoria","media"],
["2.17e",17,2,"Sex","2026-06-05",["Rev"],"Revis√£o Mat+Natureza","","Revis√£o","alta"],
["2.17f",17,2,"S√°b","2026-06-06",["Sim"],"üö® Simulado Mat+Nat (45Q)","","Simulado","alta"],
["2.17g",17,2,"Dom","2026-06-07",["Rev"],"üîç Corre√ß√£o Detalhada","","Revis√£o","alta"],

["2.18a",18,2,"Seg","2026-06-08",["Mat","F√≠s"],"Geo Anal√≠tica + Espelhos","","Teoria","media"],
["2.18b",18,2,"Ter","2026-06-09",["Mat","Qu√≠"],"Circunfer√™ncia + pH","","Teoria","media"],
["2.18c",18,2,"Qua","2026-06-10",["Mat","Bio"],"Posi√ß√µes Relativas + Bot√¢nica","","Teoria","baixa"],
["2.18d",18,2,"Qui","2026-06-11",["Hum","Ling"],"Guerra Fria + Lit.Contemp.","","Teoria","media"],
["2.18e",18,2,"Sex","2026-06-12",["Red"],"Texto 11","","Reda√ß√£o","alta"],
["2.18f",18,2,"S√°b","2026-06-13",["Sim"],"üö® Simulado Hum+Ling (45Q)","","Simulado","alta"],
["2.18g",18,2,"Dom","2026-06-14",["Rev"],"üîç Corre√ß√£o Detalhada","","Revis√£o","alta"],

["2.19x",19,2,"Seg a Sex","2026-06-15",["Rev"],"‚ö†Ô∏è RECUPERA√á√ÉO ATIVA","Refazer erros simulados. SEM mat√©ria nova.","Revis√£o","alta",true],
["2.19r",19,2,"S√°b/Dom","2026-06-20",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["2.20a",20,2,"Seg","2026-06-22",["F√≠s","Mat"],"Ondas (v=Œªf) + Rev Fun√ß√µes","","Teoria","alta"],
["2.20b",20,2,"Ter","2026-06-23",["F√≠s","Qu√≠"],"Fen√¥menos Ondas + Pilhas","","Teoria","alta"],
["2.20c",20,2,"Qua","2026-06-24",["F√≠s","Bio"],"Ac√∫stica + Excretor/Nervoso","","Teoria","media"],
["2.20d",20,2,"Qui","2026-06-25",["Hum","Ling"],"Meio Ambiente + Repert√≥rio","","Teoria","media"],
["2.20e",20,2,"Sex","2026-06-26",["Red","F√≠s"],"Texto 12 + 20Q Ondas","","Red+Q","alta"],
["2.20r",20,2,"S√°b/Dom","2026-06-27",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

// FASE 3
["3.21a",21,3,"Seg","2026-06-29",["F√≠s","Mat"],"Eletrost√°tica + Matrizes","","Teoria","alta"],
["3.21b",21,3,"Ter","2026-06-30",["F√≠s","Qu√≠"],"Campo/Potencial + Eletr√≥lise","","Teoria","media"],
["3.21c",21,3,"Qua","2026-07-01",["F√≠s","Bio"],"Poder Pontas + Tipos Sang.","","Teoria","media"],
["3.21d",21,3,"Qui","2026-07-02",["Hum","Ling"],"Constitui√ß√µes + Ingl√™s","","Teoria","media"],
["3.21e",21,3,"Sex","2026-07-03",["Red","F√≠s"],"Texto 13 + 15Q Eletrost.","","Red+Q","alta"],
["3.21r",21,3,"S√°b/Dom","2026-07-04",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["3.22a",22,3,"Seg","2026-07-06",["F√≠s","Mat"],"Corrente/Pot√™ncia + Rev Geo","(F√≠s) Chuveiro.","Teoria","alta"],
["3.22b",22,3,"Ter","2026-07-07",["F√≠s","Qu√≠"],"Ohm + Org√¢nica Cadeias","(F√≠s) V=Ri. (Qu√≠) Carbonos.","Teoria","alta"],
["3.22c",22,3,"Qua","2026-07-08",["F√≠s","Bio"],"Conta Luz + Rev Ecologia","","Teoria","alta"],
["3.22d",22,3,"Qui","2026-07-09",["Hum","Ling"],"Mov.Sociais + Arte BR","","Teoria","media"],
["3.22e",22,3,"Sex","2026-07-10",["Red","F√≠s"],"Texto 14 + 20Q Pot√™ncia","","Red+Q","alta"],
["3.22r",22,3,"S√°b/Dom","2026-07-11",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["3.23a",23,3,"Seg","2026-07-13",["F√≠s","Mat"],"S√©rie/Paralelo + Rev Geo Esp.","","Teoria","alta"],
["3.23b",23,3,"Ter","2026-07-14",["F√≠s","Qu√≠"],"Geradores + HC/√Ålcool","","Teoria","alta"],
["3.23c",23,3,"Qua","2026-07-15",["F√≠s","Bio"],"Medidores + Rev Citologia","","Teoria","media"],
["3.23d",23,3,"Qui","2026-07-16",["Hum","Ling"],"Geopol√≠tica + Fig.Linguagem","","Teoria","media"],
["3.23e",23,3,"Sex","2026-07-17",["Red","F√≠s"],"Texto 15 + 20Q Circuitos","","Red+Q","alta"],
["3.23r",23,3,"S√°b/Dom","2026-07-18",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["3.24a",24,3,"Seg","2026-07-20",["F√≠s","Mat"],"Campo Magn√©tico + Rev Estat.","","Teoria","alta"],
["3.24b",24,3,"Ter","2026-07-21",["F√≠s","Qu√≠"],"Faraday + Fun.Oxigenadas","(F√≠s) Usinas!","Teoria","alta"],
["3.24c",24,3,"Qua","2026-07-22",["F√≠s","Bio"],"Transformadores + End√≥crino","","Teoria","media"],
["3.24d",24,3,"Qui","2026-07-23",["Hum","Ling"],"Fil.Ci√™ncia + Tec/Sociedade","","Teoria","media"],
["3.24e",24,3,"Sex","2026-07-24",["Red","F√≠s"],"Texto 16 + 15Q Eletromag.","","Red+Q","alta"],
["3.24r",24,3,"S√°b/Dom","2026-07-25",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["3.25a",25,3,"Seg","2026-07-27",["F√≠s","Mat"],"Lentes/Olho + Rev Prob.","","Teoria","media"],
["3.25b",25,3,"Ter","2026-07-28",["F√≠s","Qu√≠"],"Refra√ß√£o + Nitrog./Pol√≠meros","","Teoria","media"],
["3.25c",25,3,"Qua","2026-07-29",["F√≠s","Bio"],"Rev Ondulat√≥ria + Gen√©tica","","Revis√£o","media"],
["3.25d",25,3,"Qui","2026-07-30",["Hum","Ling"],"Patrim√¥nio + Rev Lit.","","Teoria","media"],
["3.25e",25,3,"Sex","2026-07-31",["Red","Qu√≠"],"Texto 17 + Qu√≠ Ambiental","","Red+Q","alta"],
["3.25r",25,3,"S√°b/Dom","2026-08-01",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["3.26x",26,3,"Seg a Sex","2026-08-03",["Qu√≠","Rev"],"Semana 26: Refor√ßo + Isomeria","Estudo normal + Isomeria.","Teoria","media",true],
["3.26f",26,3,"S√°b","2026-08-08",["Sim"],"üö® Simulado Mat (45Q)","","Simulado","alta"],
["3.26g",26,3,"Dom","2026-08-09",["Rev"],"üîç Corre√ß√£o","","Revis√£o","alta"],

["3.27x",27,3,"Seg a Sex","2026-08-10",["Qu√≠","Rev"],"Semana 27: Rea√ß√µes Org√¢nicas","Saponifica√ß√£o, combust√£o.","Teoria","media",true],
["3.27f",27,3,"S√°b","2026-08-15",["Sim"],"üö® Simulado Natureza (45Q)","","Simulado","alta"],
["3.27g",27,3,"Dom","2026-08-16",["Rev"],"üîç Corre√ß√£o","","Revis√£o","alta"],

["3.28x",28,3,"Seg a Sex","2026-08-17",["Qu√≠","Rev"],"Semana 28: Qu√≠ Ambiental","Petr√≥leo, efeito estufa.","Teoria","alta",true],
["3.28f",28,3,"S√°b","2026-08-22",["Sim"],"üö® Simulado Linguagens (45Q)","","Simulado","alta"],
["3.28g",28,3,"Dom","2026-08-23",["Rev"],"üîç Corre√ß√£o","","Revis√£o","alta"],

["3.29x",29,3,"Seg a Sex","2026-08-24",["Bio","Hum","Rev"],"Semana 29: Rev Bio + Humanas","Leitura de Resumos.","Revis√£o","media",true],
["3.29r",29,3,"S√°b/Dom","2026-08-30",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

// FASE 4
["4.30x",30,4,"Seg a Sex","2026-08-31",["Mat","Red"],"Semana 30: Q soltas + 1 Reda√ß√£o","","Q+Red","alta",true],
["4.30f",30,4,"S√°b","2026-09-05",["Sim"],"üö® ENEM 2022 (Mat+Nat)","","Simulado","alta"],
["4.30g",30,4,"Dom","2026-09-06",["Rev"],"üîç Corre√ß√£o ENEM 2022","","Revis√£o","alta"],

["4.31x",31,4,"Seg a Sex","2026-09-07",["Mat","Red"],"Semana 31: Q soltas + 1 Reda√ß√£o","","Q+Red","alta",true],
["4.31f",31,4,"S√°b","2026-09-12",["Sim"],"üö® ENEM 2023 (Mat+Nat)","","Simulado","alta"],
["4.31g",31,4,"Dom","2026-09-13",["Rev"],"üîç Corre√ß√£o ENEM 2023","","Revis√£o","alta"],

["4.32x",32,4,"Seg a Sex","2026-09-14",["Mat","Red"],"Semana 32: Q soltas + 1 Reda√ß√£o","","Q+Red","alta",true],
["4.32f",32,4,"S√°b","2026-09-19",["Sim"],"üö® ENEM 2024 (Mat+Nat)","","Simulado","alta"],
["4.32g",32,4,"Dom","2026-09-20",["Rev"],"üîç Corre√ß√£o ENEM 2024","","Revis√£o","alta"],

["4.33x",33,4,"Seg a Sex","2026-09-21",["Rev"],"Semana 33: Revis√£o de Lacunas","APENAS os conte√∫dos mais errados.","Revis√£o","alta",true],
["4.33r",33,4,"S√°b/Dom","2026-09-27",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["4.34x",34,4,"Seg a Sex","2026-09-28",["Mat","F√≠s"],"Semana 34: Rev F√≥rmulas","√Åreas/Volumes + El√©trica.","Revis√£o","alta",true],
["4.34r",34,4,"S√°b/Dom","2026-10-04",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["4.35x",35,4,"Seg a Sex","2026-10-05",["Qu√≠","Bio"],"Semana 35: Rev Qu√≠+Bio","Ambiental + Ecologia.","Revis√£o","alta",true],
["4.35r",35,4,"S√°b/Dom","2026-10-11",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["4.36x",36,4,"Seg a Sex","2026-10-12",["Sim"],"Semana 36: Treino Estrat√©gia","Treino tempo de prova.","Estrat√©gia","alta",true],
["4.36f",36,4,"S√°b","2026-10-17",["Sim"],"üö® Simulado Cronometrado Final","","Simulado","alta"],
["4.36g",36,4,"Dom","2026-10-18",["Rev"],"üîç √öltima Corre√ß√£o","","Revis√£o","alta"],

["4.37x",37,4,"Seg a Sex","2026-10-19",["Rev","Red"],"Semana 37: Resumos + Red.Nota 1000","Leitura leve.","Leitura","media",true],
["4.37r",37,4,"S√°b/Dom","2026-10-25",["OFF"],"Descanso ou mat√©ria atrasada","","Livre","baixa",false,true],

["4.38x",38,4,"Seg a Qua","2026-10-26",["OFF"],"üèñÔ∏è Semana OFF","Revis√£o lev√≠ssima. Sono. √Ågua.","Descanso","baixa",true],
["4.38d",38,4,"Qui","2026-10-29",["OFF"],"üèñÔ∏è V√âSPERA ‚Äî N√ÉO ESTUDE","Caneta preta, docs. DURMA.","Prepara√ß√£o","alta"],
];

const T=D.map(d=>({id:d[0],sem:d[1],fase:d[2],dia:d[3],data:d[4],mat:d[5],tit:d[6],det:d[7]||'',tipo:d[8],pri:d[9],multi:!!d[10],rest:!!d[11]}));
const F={1:{e:'üü¢',n:'FASE 1: Base L√≥gica',s:'Fev‚ÄìMar',c:'var(--g)'},2:{e:'üü°',n:'FASE 2: Geometria e Mec√¢nica',s:'Abr‚ÄìJun',c:'var(--y)'},3:{e:'üîµ',n:'FASE 3: Diferencial',s:'Jul‚ÄìAgo',c:'var(--ac)'},4:{e:'üî¥',n:'FASE 4: Deploy',s:'Set‚ÄìOut',c:'var(--r)'}};
const matIcons = {
    Mat: 'üìê',
    F√≠s: '‚öõÔ∏è',
    Qu√≠: 'üß™',
    Bio: 'üß¨',
    Hum: 'üåç',
    Ling: 'üìñ',
    Red: '‚úçÔ∏è',
    Rev: 'üîç',
    Sim: 'üìä',
    OFF: 'üò¥'
};
// ===== STATE =====
let dn=J('cc_d',{}),nt=J('cc_n',{}),sk=J('cc_s',{c:0,d:[]}),oP=J('cc_p',{1:1,2:1,3:1,4:1}),oW=J('cc_w',{}),xp={},mI=null;
function J(k,d){try{return JSON.parse(localStorage.getItem(k))||d}catch{return d}}
function S(){['cc_d','cc_n','cc_s','cc_p','cc_w'].forEach((k,i)=>localStorage.setItem(k,JSON.stringify([dn,nt,sk,oP,oW][i])))}
const $=s=>document.querySelector(s);

// ===== AUDIO BEEP =====
let audioCtx;
function beep(freq=880,dur=.3,type='sine'){
    if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();
    const o=audioCtx.createOscillator(),g=audioCtx.createGain();
    o.type=type;o.frequency.value=freq;g.gain.value=.3;
    o.connect(g);g.connect(audioCtx.destination);
    o.start();g.gain.exponentialRampToValueAtTime(.001,audioCtx.currentTime+dur);
    o.stop(audioCtx.currentTime+dur)
}
function alarm(){beep(880,.15);setTimeout(()=>beep(1100,.15),200);setTimeout(()=>beep(880,.15),400);setTimeout(()=>beep(1100,.2),600)}

// ===== TIMER =====
let tPh='theory',tSc=35*60,tMx=35*60,tRn=false,tIn=null,tEd=false,tTh=35*60,tPr=85*60;
let tSt=parseInt(J('cc_ts_'+new Date().toISOString().split('T')[0],0));

function tTog(){if(tPh==='done'){tRst();return}
if(tRn){clearInterval(tIn);tRn=false;$('[data-t="go"]').textContent='‚ñ∂ Continuar';$('[data-t="go"]').classList.remove('run')}
else{if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();tRn=true;$('[data-t="go"]').textContent='‚è∏ Pausar';$('[data-t="go"]').classList.add('run');tIn=setInterval(tick,1000)}}

function tick(){tSc--;tSt++;localStorage.setItem('cc_ts_'+new Date().toISOString().split('T')[0],tSt);
if(tSc<=0){if(tPh==='theory'){tPh='practice';tSc=tPr;tMx=tPr;alarm();toast('üìù Teoria ok! QUEST√ïES!');try{navigator.vibrate([200,100,200])}catch{}}
else{tPh='done';tRn=false;clearInterval(tIn);alarm();setTimeout(alarm,1000);toast('üèÜ Sess√£o completa!');confetti();try{navigator.vibrate([300,200,300,200,300])}catch{};const td=new Date().toISOString().split('T')[0];if(!sk.d.includes(td)){sk.d.push(td);S()}upD()}}
showNotification("Sess√£o completa!", "Parab√©ns! Voc√™ terminou o bloco de hoje. üèÜ");rT()}

function tSkip(){if(tPh==='theory'){tPh='practice';tSc=tPr;tMx=tPr;beep();toast('‚è≠ Quest√µes!')}else if(tPh==='practice'){tPh='done';tRn=false;clearInterval(tIn);beep();toast('‚è≠ Fim')}rT()}
function tRst(){clearInterval(tIn);tRn=false;tPh='theory';tSc=tTh;tMx=tTh;$('[data-t="go"]').textContent='‚ñ∂ Iniciar';$('[data-t="go"]').classList.remove('run');rT()}
function openEd(){if(tRn)return;tEd=true;$('[data-t="edit"]').classList.add('show');document.getElementById('em').value=Math.floor(tSc/60);document.getElementById('es').value=tSc%60;$('[data-t="disp"]').classList.add('editing');document.getElementById('em').focus()}
function applyEd(){const m=parseInt(document.getElementById('em').value)||0,s=parseInt(document.getElementById('es').value)||0,tot=m*60+s;if(tPh==='theory'){tSc=tot;tMx=tot;tTh=tot}else{tSc=tot;tMx=tot;tPr=tot}cancelEd();rT();toast('‚è±Ô∏è Atualizado!')}
function cancelEd(){tEd=false;$('[data-t="edit"]').classList.remove('show');$('[data-t="disp"]').classList.remove('editing')}
function pre(m){if(tRn)return;const tot=m*60;if(tPh==='theory'){tSc=tot;tMx=tot;tTh=tot}else{tSc=tot;tMx=tot;tPr=tot}rT();toast(`‚è±Ô∏è ${m}min`)}
function rT(){const d=$('[data-t="disp"]'),mn=Math.floor(Math.abs(tSc)/60),sc=Math.abs(tSc)%60,ng=tSc<0?'-':'';d.textContent=`${ng}${String(mn).padStart(2,'0')}:${String(sc).padStart(2,'0')}`;d.className='t-disp '+(tSc<0?'overtime':tPh==='done'?'practice':tPh)+(tEd?' editing':'');$('[data-t="lbl"]').textContent=tPh==='theory'?`üìñ TEORIA (${Math.floor(tTh/60)}min)`:tPh==='practice'?`üìù QUEST√ïES (${Math.floor(tPr/60)}min)`:'‚úÖ COMPLETA!';$('[data-t="d1"]').className='t-dot'+(tPh==='theory'?' at':tPh!=='theory'?' dn':'');$('[data-t="d2"]').className='t-dot'+(tPh==='practice'?' ap':tPh==='done'?' dn':'');const bar=$('[data-t="bar"]'),pct=tMx>0?Math.max(0,(tSc/tMx)*100):0;bar.style.width=pct+'%';bar.className='t-bf '+(tPh==='done'?'practice':tPh);if(tPh==='done'){$('[data-t="go"]').textContent='‚Ü∫ Nova';$('[data-t="go"]').classList.remove('run')}$('[data-t="tot"]').textContent=Math.floor(tSt/60)+' min'}

// ===== SYNC =====
function expP(){const d={v:3,dn,nt,sk,ts:Date.now()};document.getElementById('sc').value=btoa(unescape(encodeURIComponent(JSON.stringify(d))));document.getElementById('sc').classList.add('show');document.getElementById('sc').readOnly=true;$('[data-sy="ib"]').classList.remove('show');toast('üì§ C√≥digo gerado!')}
function showI(){const e=document.getElementById('sc');e.value='';e.classList.add('show');e.readOnly=false;e.focus();$('[data-sy="ib"]').classList.add('show')}
function hideI(){document.getElementById('sc').classList.remove('show');$('[data-sy="ib"]').classList.remove('show')}
function impP(){try{const r=document.getElementById('sc').value.trim(),j=JSON.parse(decodeURIComponent(escape(atob(r))));if(!j.dn&&!j.done)throw 0;const src=j.dn||j.done;const n=Object.keys(src).length;if(!confirm(`Importar ${n} tarefas?`))return;dn=src;nt=j.nt||j.notes||{};sk=j.sk||j.strk||{c:0,d:[]};S();hideI();draw();toast(`‚úÖ ${n} importadas!`)}catch{toast('‚ùå C√≥digo inv√°lido!')}}
function cpC(){const e=document.getElementById('sc');if(!e.value)expP();navigator.clipboard?navigator.clipboard.writeText(e.value).then(()=>toast('üìã Copiado!')):toast('Copie manualmente')}
function shP(){expP();const c=document.getElementById('sc').value;navigator.share?navigator.share({title:'ENEM2026',text:c}).catch(()=>{}):cpC()}

// ===== DRAW =====
function fil(){const s=document.getElementById('si').value.toLowerCase(),f=document.getElementById('ff').value,m=document.getElementById('fm').value,st=document.getElementById('fs').value;return T.filter(t=>{if(s&&!t.tit.toLowerCase().includes(s)&&!t.det.toLowerCase().includes(s))return!1;if(f&&t.fase!=f)return!1;if(m&&!t.mat.includes(m))return!1;if(st==='d'&&!dn[t.id])return!1;if(st==='p'&&dn[t.id])return!1;return!0})}

function draw(){
const tasks=fil(),c=document.getElementById('ct'),g={};
tasks.forEach(t=>{if(!g[t.fase])g[t.fase]={};if(!g[t.fase][t.sem])g[t.fase][t.sem]=[];g[t.fase][t.sem].push(t)});
let h='';
[1,2,3,4].forEach(fn=>{if(!g[fn])return;const f=F[fn],ids=Object.values(g[fn]).flat().map(t=>t.id),dc=ids.filter(id=>dn[id]).length,pct=ids.length?Math.round(dc/ids.length*100):0,op=oP[fn]!==false;
h+=`<section class="ph ${op?'':'cl'}" data-p="${fn}"><div class="ph-h" role="button" tabindex="0" onclick="tP(${fn})" aria-expanded="${op}"><div class="ph-e">${f.e}</div><div class="ph-i"><div class="ph-t">${f.n}</div><div class="ph-s">${f.s}</div></div><span class="ph-c" style="color:${f.c}">${dc}/${ids.length}¬∑${pct}%</span><span class="ph-a">‚ñº</span></div><div class="ph-b" style="max-height:${op?'999999px':'0'};opacity:${op?1:0}">`;
Object.keys(g[fn]).sort((a,b)=>a-b).forEach(w=>{const wt=g[fn][w],wd=wt.filter(t=>dn[t.id]).length,wk=fn+'-'+w,wo=oW[wk]!==false,wc=wd===wt.length,d1=fmt(wt[0].data),d2=fmt(wt[wt.length-1].data);
h+=`<article class="wk ${wo?'':'cl'}"><div class="wk-h" role="button" tabindex="0" onclick="tW('${wk}')" aria-expanded="${wo}"><div class="wk-d ${wc?'cpl':''}" style="background:${f.c}"></div><span class="wk-t">Semana ${w}</span><span class="wk-bg">${d1}‚Üí${d2}</span><span class="wk-bg ${wc?'wd':''}">${wd}/${wt.length}‚úì</span><span class="wk-ar">‚ñº</span></div><div class="wk-b" style="max-height:${wo?'999999px':'0'};opacity:${wo?1:0}">`;
wt.forEach(t=>{const d2=dn[t.id],ex=xp[t.id],hn=nt[t.id],isSm=t.mat.includes('Sim')||t.tipo==='Simulado';
h+=`<article class="tk p-${t.pri} ${d2?'done':''} ${ex?'exp':''} ${t.multi?'multi':''} ${isSm?'sim':''} ${t.rest?'rest':''}" data-id="${t.id}" onclick="tE('${t.id}')"><button type="button" class="ck ${d2?'on':''}" onclick="event.stopPropagation();ck('${t.id}')" aria-label="Check"></button><div class="tk-c"><h4>${t.tit}</h4>${t.det?`<p>${t.det}</p>`:''}<div class="tk-tags">
    ${t.mat.map(m => `<span class="tg tg-${m}">${matIcons[m] || 'üìå'} ${m}</span>`).join('')}
    <span class="tg" style="background:rgba(124,92,252,.05);color:var(--ac2)">${t.tipo}</span>
</div></div><div class="tk-m">
    <span class="dy">${t.dia}</span>
    <time datetime="${t.data}">${fmt(t.data)}</time>
 <button type="button" class="nbtn${hn ? ' has' : ''}" onclick="event.stopPropagation(); oM('${t.id}')">üìù</button>
</div></article>`});
h+=`</div></article>`});h+=`</div></section>`});
c.innerHTML=h||'<div class="empty">üîç Nada encontrado</div>';upD()  
}

function ck(id){const b=document.querySelector(`[data-id="${id}"] .ck`);if(dn[id]){delete dn[id];toast('‚¨ú Desmarcada')}else{dn[id]=Date.now();if(b)b.classList.add('on');beep(660,.1);toast('‚úÖ Conclu√≠da!');const td=new Date().toISOString().split('T')[0];if(!sk.d.includes(td))sk.d.push(td);const n=Object.keys(dn).length;if(n%10===0){toast(`üî• ${n} tarefas!`);confetti()}if(n===T.length){toast('üèÜ 100%!!');confetti();confetti()}}S();draw()}
function tE(id){xp[id]=!xp[id];draw()}
function tP(n){oP[n]=oP[n]===false;S();draw()}
function tW(k){oW[k]=oW[k]===false;S();draw()}
function eAll(){[1,2,3,4].forEach(n=>oP[n]=true);T.forEach(t=>oW[t.fase+'-'+t.sem]=true);S();draw()}
function cAll(){[1,2,3,4].forEach(n=>oP[n]=false);Object.keys(oW).forEach(k=>oW[k]=false);S();draw()}

function upD(){const total=T.length,d=Object.keys(dn).length,pct=total?Math.round(d/total*100):0,td=new Date().toISOString().split('T')[0];
$('[data-st="total"]').textContent=total;$('[data-st="done"]').textContent=d;$('[data-st="pend"]').textContent=total-d;
$('[data-st="today"]').textContent=T.filter(t=>t.data===td).length;
$('[data-st="red"]').textContent=T.filter(t=>t.mat.includes('Red')&&dn[t.id]).length;
$('[data-st="sim"]').textContent=T.filter(t=>(t.mat.includes('Sim')||t.tipo==='Simulado')&&dn[t.id]).length;
$('[data-pr="pct"]').textContent=pct+'%';$('[data-pr="bar"]').style.width=pct+'%';
[1,2,3,4].forEach(f=>{const ft=T.filter(t=>t.fase===f),fd=ft.filter(t=>dn[t.id]).length,fp=ft.length?Math.round(fd/ft.length*100):0;$(`[data-pr="f${f}"]`).style.width=fp+'%';$(`[data-pr="p${f}"]`).textContent=fp+'%'});
const dates=sk.d.sort();let sc=0;const now=new Date();for(let i=0;i<60;i++){const d=new Date(now);d.setDate(now.getDate()-i);if(dates.includes(d.toISOString().split('T')[0]))sc++;else if(i>0)break}
sk.c=sc;$('[data-s="n"]').textContent=sc;let dots='';for(let i=20;i>=0;i--){const d=new Date(now);d.setDate(now.getDate()-i);const ds=d.toISOString().split('T')[0];dots+=`<div class="s-c ${dates.includes(ds)?'on':''} ${i===0?'now':''}"></div>`}$('[data-s="g"]').innerHTML=dots;rT()}

function oM(id){
    mI = id;
    const task = T.find(t => t.id === id);          
    $('[data-dl="t"]').textContent = task.tit;
    document.getElementById('nt').value = nt[id] ? (typeof nt[id] === 'object' ? nt[id].text || '' : nt[id]) : '';

    
    if (task && (task.mat.includes('Red') || task.tipo.includes('Red'))) {
        $('#redExtra').style.display = 'block';

                if (nt[id] && typeof nt[id] === 'object') {
            $('#redNota').value = nt[id].nota || '';
           if (nt[id] && nt[id].img) {
    $('#imgPreview').innerHTML = `<img src="${nt[id].img}" style="max-width:100%; border-radius:8px;">`;
    $('#redNota').value = nt[id].nota || '';
}
        } else {
            $('#redNota').value = '';
            $('#imgPreview').innerHTML = '';
        }
    } else {
        $('#redExtra').style.display = 'none';
        $('#redNota').value = '';
        $('#imgPreview').innerHTML = '';
    }

    document.getElementById('dlg').showModal();
}
function cDlg(){document.getElementById('dlg').close();mI=null}
function sN(){
    const textareaValue = document.getElementById('nt').value.trim();

    if ($('#redExtra').style.display !== 'none') {
        // √â reda√ß√£o ‚Üí salva como objeto
        const nota = $('#redNota').value.trim();
        const fileInput = $('#redImg');

        if (fileInput.files && fileInput.files[0]) {
            // Tem nova foto ‚Üí l√™ e salva tudo
            const reader = new FileReader();
            reader.onload = function(ev) {
                nt[mI] = {
                    text: textareaValue,
                    nota: nota || '',
                    img: ev.target.result
                };
                S();
                cDlg();
                toast('Reda√ß√£o salva com foto e nota!');
                draw();
            };
            reader.readAsDataURL(fileInput.files[0]);
            return; // Espera o onload terminar (async)
        } else {
            // Sem nova foto ‚Üí mant√©m a anterior se existir
            let existingImg = '';
            if (nt[mI] && typeof nt[mI] === 'object' && nt[mI].img) {
                existingImg = nt[mI].img;
            }
            nt[mI] = {
                text: textareaValue,
                nota: nota || '',
                img: existingImg
            };
        }
    } else {
        // N√£o √© reda√ß√£o ‚Üí salva como string simples
        if (textareaValue) {
            nt[mI] = textareaValue;
        } else {
            delete nt[mI];
        }
    }

    S();
    cDlg();
    toast('üíæ Salvo!');
    draw();
}
function eCSV(){let c='\uFEFF"Sem","Fase","Dia","Data","Mat","T√≠tulo","Det","Tipo","Pri","Feito"\n';T.forEach(t=>{c+=`${t.sem},"${F[t.fase].n}","${t.dia}","${t.data}","${t.mat.join(',')}","${t.tit}","${t.det.replace(/"/g,'""')}","${t.tipo}","${t.pri}","${dn[t.id]?'TRUE':'FALSE'}"\n`});const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([c],{type:'text/csv;charset=utf-8;'}));a.download='enem2026_cc.csv';a.click();toast('üì• CSV!')}
function rAll(){if(!confirm('‚ö†Ô∏è Apagar TUDO?'))return;dn={};nt={};sk={c:0,d:[]};localStorage.clear();S();draw();toast('üîÑ Reset!')}
function fmt(d){const[y,m,dd]=d.split('-');return dd+'/'+m}
function toast(m){const t=document.createElement('div');t.className='toast';t.textContent=m;document.getElementById('toasts').appendChild(t);setTimeout(()=>t.remove(),3000)}
function confetti(){const cv=document.getElementById('confetti'),ctx=cv.getContext('2d');cv.width=innerWidth;cv.height=innerHeight;const ps=[],cl=['#22c55e','#eab308','#7c5cfc','#ef4444','#f97316','#06b6d4','#ec4899'];for(let i=0;i<80;i++)ps.push({x:Math.random()*cv.width,y:-10-Math.random()*200,vx:(Math.random()-.5)*7,vy:Math.random()*3+2,c:cl[~~(Math.random()*cl.length)],s:Math.random()*4+2,r:Math.random()*360,rs:(Math.random()-.5)*10,l:1});(function go(){ctx.clearRect(0,0,cv.width,cv.height);let a=false;ps.forEach(p=>{if(p.l<=0)return;a=true;p.x+=p.vx;p.vy+=.1;p.y+=p.vy;p.r+=p.rs;p.l-=.007;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.r*Math.PI/180);ctx.globalAlpha=p.l;ctx.fillStyle=p.c;ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s*.6);ctx.restore()});if(a)requestAnimationFrame(go);else ctx.clearRect(0,0,cv.width,cv.height)})()}
document.addEventListener('keydown',e=>{if(e.key==='Escape'){cDlg();cancelEd()}});

function showNotesList() {
    const notesIds = Object.keys(nt);
    if (notesIds.length === 0) {
        toast("Nenhuma anota√ß√£o salva ainda.");
        return;
    }

    let html = `
        <h3 style="margin-bottom:12px">Anota√ß√µes salvas (${notesIds.length})</h3>
        <div style="max-height:60vh;overflow-y:auto;font-size:0.9rem;line-height:1.5">
    `;

    notesIds.sort().forEach(id => {
        const task = T.find(t => t.id === id);
        if (!task) return;

        const dataFmt = fmt(task.data);
        const dataTitle = task.tit.length > 45 ? task.tit.substring(0,42) + "..." : task.tit;

        // Corre√ß√£o principal: pega o texto corretamente (seja string ou objeto)
        let notaText = '';
        if (typeof nt[id] === 'object' && nt[id] !== null) {
            notaText = nt[id].text || '';  // pega o campo 'text' do objeto
        } else {
            notaText = nt[id] || '';       // se for string antiga
        }

        const notaPreview = notaText.substring(0,120) + (notaText.length > 120 ? "..." : "");

        html += `
            <div style="padding:10px 12px;margin:6px 0;background:var(--bg3);border-radius:8px;border-left:4px solid var(--ac);">
                <strong>${dataFmt} ‚Ä¢ ${task.dia}</strong><br>
                <span style="color:var(--ac2)">${dataTitle}</span><br>
                <div style="margin-top:6px;color:var(--t2);font-size:0.82rem">
                    ${notaPreview}
                </div>
                <button type="button" class="nbtn" style="margin-top:8px;font-size:0.7rem;" 
                    onclick="oM('${id}'); document.getElementById('dlg').showModal();">
                    ‚úèÔ∏è Ver/Editar
                </button>
            </div>
        `;
    });

    html += `</div>`;

    const tempDialog = document.createElement('dialog');
    tempDialog.innerHTML = `
        <div style="position:relative;">
            <button type="button" style="position:absolute;top:0;right:0;padding:8px 12px;background:transparent;border:none;font-size:1.2rem;cursor:pointer;color:var(--t);" 
                onclick="this.closest('dialog').close();this.closest('dialog').remove();">‚úñ</button>
            ${html}
        </div>
    `;
    document.body.appendChild(tempDialog);
    tempDialog.showModal();

    tempDialog.addEventListener('click', e => {
        if (e.target === tempDialog) {
            tempDialog.close();
            tempDialog.remove();
        }
    });
}
function exportAsImage() {
    const element = document.querySelector('.app'); // ou '#ct' se quiser s√≥ o cronograma
    html2canvas(element, {scale: 2, useCORS: true, backgroundColor: null}).then(canvas => {
        const link = document.createElement('a');
        link.download = 'cronograma_enem2026.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
        toast('üñºÔ∏è Imagem baixada!');
    }).catch(err => {
        toast('‚ùå Erro ao gerar imagem');
        console.error(err);
    });
}
function requestNotificationPermission() {
    if (!("Notification" in window)) {
        toast("Notifica√ß√µes n√£o suportadas no seu navegador.");
        return;
    }
    Notification.requestPermission().then(permission => {
        if (permission === "granted") {
            toast("Notifica√ß√µes ativadas! üéâ");
        } else {
            toast("Permiss√£o negada para notifica√ß√µes.");
        }
    });
}

function showNotification(title, body) {
    if (Notification.permission === "granted") {
        new Notification(title, {body: body, icon: '/favicon.ico'}); // opcional: mude o icon se tiver um favicon
    }
}

window.addEventListener('load', function() {
    const redImgInput = document.getElementById('redImg');
    if (redImgInput) {
        redImgInput.onchange = function(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(ev) {
                const previewDiv = document.getElementById('imgPreview');
                if (previewDiv) {
                    previewDiv.innerHTML = `<img src="${ev.target.result}" style="max-width:100%;">`;
                }
            };
            reader.readAsDataURL(file);
        };
    }
});
function toggleMusic() {
    const player = $('#musicPlayer');
    const frame = $('#lofiFrame');
    if (player.style.display === 'none') {
        player.style.display = 'block';
        frame.src = frame.src.replace('autoplay=0', 'autoplay=1'); // inicia ao abrir
        toast('Lo-fi ativado! üé∂');
    } else {
        player.style.display = 'none';
        frame.src = frame.src.replace('autoplay=1', 'autoplay=0'); // pausa ao fechar
        toast('M√∫sica pausada');
    }
}
function loadCustomMusic() {
    const input = document.getElementById('playlistInput');
    const frame = document.getElementById('lofiFrame');
    let url = input.value.trim();

    if (!url) {
        toast('Cole um link ou ID v√°lido!');
        return;
    }

    // Extrai ID de v√≠deo ou playlist
    let videoId = '';
    let playlistId = '';

    // Caso seja link completo
    if (url.includes('youtube.com/watch?v=')) {
        const match = url.match(/v=([^&]+)/);
        if (match) videoId = match[1];
    } else if (url.includes('youtu.be/')) {
        videoId = url.split('/').pop().split('?')[0];
    } else if (url.includes('list=')) {
        const match = url.match(/list=([^&]+)/);
        if (match) playlistId = match[1];
    } else {
        // Assume que colou s√≥ o ID
        if (url.startsWith('PL')) {
            playlistId = url;
        } else {
            videoId = url;
        }
    }

    let newSrc = '';
    if (playlistId) {
        // Formato para playlist: videoseries?list=PL...
        newSrc = `https://www.youtube-nocookie.com/embed/videoseries?list=${playlistId}&autoplay=1&controls=1&mute=0`;
        toast('Playlist carregada! üé∂');
    } else if (videoId) {
        newSrc = `https://www.youtube-nocookie.com/embed/${videoId}?autoplay=1&controls=1&mute=0`;
        toast('V√≠deo carregado! ‚ñ∂');
    } else {
        toast('Link/ID inv√°lido. Tente novamente.');
        return;
    }

    // Atualiza o iframe
    frame.src = newSrc;
}
function showSpacedReview() {
    const today = new Date();
    const toReview = T.filter(t => {
        if (!dn[t.id]) return false;
        const doneDate = new Date(dn[t.id]);
        const daysAgo = Math.floor((today - doneDate) / (86400000)); // 1000*60*60*24 = 86400000
        return [7, 14, 30, 90].includes(daysAgo);
    });

    if (toReview.length === 0) {
        toast("Nenhuma revis√£o espa√ßada pendente agora.");
        return;
    }

    let html = '<h3>Revis√£o Espa√ßada Sugerida</h3><p>Priorize essas para fixar o conte√∫do:</p><ul style="margin:12px 0; padding-left:20px;">';
    toReview.forEach(t => {
        const days = Math.floor((today - new Date(dn[t.id])) / 86400000);
        html += `<li><strong>${t.tit}</strong> (${fmt(t.data)}) ‚Äî feito h√° <b>${days} dias</b></li>`;
    });
    html += '</ul>';

    const dlg = document.createElement('dialog');
    dlg.innerHTML = `
        <div style="position:relative; padding:20px;">
            ${html}
            <button type="button" style="position:absolute;top:10px;right:10px; background:transparent; border:none; font-size:1.4rem; cursor:pointer;" 
                onclick="this.closest('dialog').close(); this.closest('dialog').remove();">‚úñ</button>
            <button type="button" class="bt bt-p" onclick="this.closest('dialog').close(); this.closest('dialog').remove();">Fechar</button>
        </div>
    `;
    document.body.appendChild(dlg);
    dlg.showModal();
}
function showRedGallery() {
    const reds = Object.entries(nt).filter(([id, val]) => val.img && T.find(t=>t.id===id)?.mat.includes('Red'));
    if (reds.length === 0) return toast("Nenhuma reda√ß√£o com foto salva.");
    let html = '<h3>Galeria de Reda√ß√µes</h3><div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(150px,1fr)); gap:10px;">';
    reds.forEach(([id, val]) => {
        const task = T.find(t=>t.id===id);
        html += `
            <div style="text-align:center;">
                <img src="${val.img}" style="width:100%; border-radius:8px; cursor:pointer;" onclick="alert('Nota: ${val.nota || '?'} | ${task?.tit || id}')">
                <small>${fmt(task?.data || 'Data perdida')} - ${val.nota || '?'}pts</small>
            </div>`;
    });
    html += '</div>';
    // Use temp dialog como antes
    const dlg = document.createElement('dialog');
    dlg.innerHTML = `<div style="padding:20px;">${html}<button onclick="this.closest('dialog').close();this.closest('dialog').remove();">Fechar</button></div>`;
    document.body.appendChild(dlg);
    dlg.showModal();
}
function highlightHoje() {
    const dataEl = document.getElementById('dataHojeTexto');
    const tarefaEl = document.getElementById('tarefaHoje');
    
    if (!dataEl || !tarefaEl) {
        // Se os elementos ainda n√£o carregaram, tenta novamente em 100ms
        setTimeout(highlightHoje, 100);
        return;
    }

    const hoje = new Date();
    const hojeStr = hoje.toISOString().split('T')[0];
    const diaSemana = hoje.toLocaleDateString('pt-BR', { weekday: 'long' });
    const dataFormatada = hoje.toLocaleDateString('pt-BR', {
        day: '2-digit', month: '2-digit', year: 'numeric'
    });

    dataEl.textContent = `Hoje: ${dataFormatada} (${diaSemana.charAt(0).toUpperCase() + diaSemana.slice(1)})`;

    const tarefa = T.find(t => t.data === hojeStr);

    if (tarefa) {
        tarefaEl.textContent = `${tarefa.dia}: ${tarefa.tit} (${tarefa.mat.join(' + ')})`;
        tarefaEl.style.color = tarefa.pri === 'alta' ? 'var(--r)' : 'var(--g)';
    } else {
        tarefaEl.textContent = 'Dia livre ou sem tarefa marcada hoje!';
        tarefaEl.style.color = 'var(--t3)';
    }

    // Destacar tarefa do dia (se existir no cronograma)
    document.querySelectorAll('.tk').forEach(tk => tk.style.opacity = '0.6');
    const hojeEl = document.querySelector(`.tk time[datetime="${hojeStr}"]`);
    if (hojeEl) {
        const card = hojeEl.closest('.tk');
        card.style.opacity = '1';
        card.style.border = '2px solid var(--ac)';
        card.style.boxShadow = '0 0 10px var(--ac)';
        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}
function fmt(dateStr) {
    const [y, m, d] = dateStr.split('-');
    return `${d}/${m}/${y}`;
}
window.addEventListener('load', () => {
    draw();
    highlightHoje();
});
</script>
</body>
</html>
